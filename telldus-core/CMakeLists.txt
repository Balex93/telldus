PROJECT( telldus-core )

CMAKE_MINIMUM_REQUIRED( VERSION 2.6.0 )

CMAKE_POLICY(SET CMP0003 NEW)

OPTION(FORCE_COMPILE_FROM_TRUNK FALSE "Accept compiling souce from trunk. This is unsupported and highly unrecommended")
IF(NOT FORCE_COMPILE_FROM_TRUNK)
	MESSAGE(FATAL_ERROR "You are compiling sources from trunk. Don't do that!")
ENDIF(NOT FORCE_COMPILE_FROM_TRUNK)

SET(PACKAGE_MAJOR_VERSION 2)
SET(PACKAGE_MINOR_VERSION 0)
SET(PACKAGE_PATCH_VERSION 103)
SET(PACKAGE_VERSION "${PACKAGE_MAJOR_VERSION}.${PACKAGE_MINOR_VERSION}.${PACKAGE_PATCH_VERSION}")
SET(PACKAGE_SUBVERSION)
SET(PACKAGE_SOVERSION 2)

IF (PACKAGE_SUBVERSION)
  SET(DISPLAYED_VERSION "${PACKAGE_VERSION}_${PACKAGE_SUBVERSION}")
ELSE (PACKAGE_SUBVERSION)
  SET(DISPLAYED_VERSION ${PACKAGE_VERSION})
ENDIF(PACKAGE_SUBVERSION)

SET(BUILD_LIBTELLDUS-CORE	TRUE	CACHE BOOL "Build libtelldus-core")

SET(USE_QT_SETTINGS_BACKEND FALSE CACHE BOOL "Use QT as settings backend instead of the native one")
IF (WIN32)
	SET(SIGN_FILES FALSE CACHE BOOL "Sign the generated files. This requires a certificate to be installed on the computer!")
ENDIF (WIN32)

IF (WIN32)
	SET(TOOLS_DEFAULT FALSE)
ELSE (WIN32)
	SET(TOOLS_DEFAULT TRUE)
ENDIF (WIN32)
SET(BUILD_TDTOOL	${TOOLS_DEFAULT}	CACHE BOOL "Build tdtool")
SET(BUILD_TDADMIN	${TOOLS_DEFAULT}	CACHE BOOL "Build tdadmin")

SET(GENERATE_MAN	FALSE	CACHE	BOOL "Enable generation of man-files")

# Lets figure if we need to build against Qt or not
IF(USE_QT_SETTINGS_BACKEND)
	SET(BUILD_WITH_QT TRUE)
ENDIF(USE_QT_SETTINGS_BACKEND)

ADD_SUBDIRECTORY(common)
ADD_SUBDIRECTORY(service)
ADD_SUBDIRECTORY(client)

IF(BUILD_TDTOOL)
	ADD_SUBDIRECTORY(tdtool)
ENDIF(BUILD_TDTOOL)
IF(BUILD_TDADMIN)
	ADD_SUBDIRECTORY(tdadmin)
ENDIF(BUILD_TDADMIN)
